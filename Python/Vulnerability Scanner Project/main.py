from network_scanner import network_scan
from web_scanner import check_sql_injection

def display_devices(devices):
    """
    Displays the list of discovered devices in a user-friendly format.
    
    :param devices: A list of dictionaries containing IP and MAC addresses of devices.
    """
    if devices:
        print(f"\nFound {len(devices)} device(s):\n")
        print(f"{'IP Address':<15} {'MAC Address':<17}")
        print("-" * 33)
        for device in devices:
            print(f"{device['ip']:<15} {device['mac']:<17}")
    else:
        print("\nNo devices found on the network.")

def run_network_scan():
    ip_range = input("Please enter the IP range to scan (e.g., 192.168.0.1/24): ")
    if not ip_range:
        print("IP range is required to proceed.")
        return
    print(f"\nScanning network: {ip_range}")
    devices = network_scan(ip_range)
    display_devices(devices)
    print("\nNetwork scan completed.")

def run_sql_injection_test():
    url = input("Please enter the URL to test for SQL Injection (e.g., http://example.com/login.php?username=): ")
    
    # Add 'http://' if the user didn't include a scheme in the URL
    if not url.startswith(("http://", "https://")):
        url = "http://" + url

    print(f"\nTesting URL for SQL Injection: {url}")
    is_vulnerable = check_sql_injection(url)
    
    if is_vulnerable:
        print(f"The URL {url} is vulnerable to SQL Injection.")
    else:
        print(f"The URL {url} is not vulnerable to SQL Injection.")
    
    print("\nSQL Injection test completed.")

def main():
    print("Welcome to the Cybersecurity Tool Suite")
    print("Choose an option:")
    print("1. Run Network Scan")
    print("2. Run SQL Injection Test")
    choice = input("Enter your choice (1 or 2): ")

    if choice == "1":
        run_network_scan()
    elif choice == "2":
        run_sql_injection_test()
    else:
        print("Invalid choice. Please choose 1 or 2.")
    
    print("\nExiting the tool.")

if __name__ == "__main__":
    main()
